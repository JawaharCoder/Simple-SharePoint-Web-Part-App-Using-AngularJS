{"version":3,"sources":["webparts/toDoWebPart/app/HomeController.ts"],"names":[],"mappings":"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","file":"webparts/toDoWebPart/app/HomeController.js","sourcesContent":["import { IDataService, ITodo } from './DataService';\n\nexport default class HomeController {\n  public static $inject: string[] = ['DataService', '$window', '$rootScope'];\n\n  public isLoading: boolean = false;\n  public newItem: string = undefined;\n  public todoCollection: any[] = [];\n  private sharePointApi: string = undefined;\n  private todoListName: string = undefined;\n  private hideFinishedTasks: boolean = false;\n  private configurationNeeded: boolean = true;\n\n  constructor(private dataService: IDataService,\n              private $window: ng.IWindowService,\n              private $rootScope: ng.IRootScopeService) {\n    const vm: HomeController = this;\n    this.init(undefined, undefined);\n\n    $rootScope.$on('configurationChanged',\n      (event: ng.IAngularEvent,\n       args: {\n         sharePointApi: string;\n         todoListName: string;\n         hideFinishedTasks: boolean\n        }): void => {\n      vm.init(args.sharePointApi, args.todoListName, args.hideFinishedTasks);\n    });\n  }\n\n  public todoKeyDown($event: any): void {\n    if ($event.keyCode === 13 && this.newItem.length > 0) {\n      $event.preventDefault();\n\n      this.todoCollection.unshift({ id: -1, title: this.newItem, done: false });\n      const vm: HomeController = this;\n\n      this.dataService.addTodo(this.newItem, vm.sharePointApi, vm.todoListName)\n        .then((): void => {\n          this.newItem = undefined;\n          this.dataService.getTodos(vm.sharePointApi, vm.todoListName, vm.hideFinishedTasks)\n            .then((todos: any[]): void => {\n              this.todoCollection = todos;\n            });\n        });\n    }\n  }\n\n  public deleteTodo(todo: ITodo): void {\n    if (this.$window.confirm('Are you sure you want to delete this todo item?')) {\n      let index: number = -1;\n      for (let i: number = 0; i < this.todoCollection.length; i++) {\n        if (this.todoCollection[i].id === todo.id) {\n          index = i;\n          break;\n        }\n      }\n\n      if (index > -1) {\n        this.todoCollection.splice(index, 1);\n      }\n\n      const vm: HomeController = this;\n\n      this.dataService.deleteTodo(todo, vm.sharePointApi, vm.todoListName)\n        .then((): void => {\n          this.dataService.getTodos(vm.sharePointApi, vm.todoListName, vm.hideFinishedTasks)\n            .then((todos: any[]): void => {\n              this.todoCollection = todos;\n            });\n        });\n    }\n  }\n\n  public completeTodo(todo: ITodo): void {\n    todo.done = true;\n\n    const vm: HomeController = this;\n\n    this.dataService.setTodoStatus(todo, true, vm.sharePointApi, vm.todoListName)\n      .then((): void => {\n        this.dataService.getTodos(vm.sharePointApi, vm.todoListName, vm.hideFinishedTasks)\n          .then((todos: any[]): void => {\n            this.todoCollection = todos;\n          });\n      });\n  }\n\n  public undoTodo(todo: ITodo): void {\n    todo.done = false;\n\n    const vm: HomeController = this;\n\n    this.dataService.setTodoStatus(todo, false, vm.sharePointApi, vm.todoListName)\n      .then((): void => {\n        this.dataService.getTodos(vm.sharePointApi, vm.todoListName, vm.hideFinishedTasks)\n          .then((todos: any[]): void => {\n            this.todoCollection = todos;\n          });\n      });\n  }\n\n  private init(sharePointApi: string, todoListName: string, hideFinishedTasks?: boolean): void {\n    if (sharePointApi !== undefined && sharePointApi.length > 0 &&\n      todoListName !== undefined && todoListName.length > 0) {\n      this.sharePointApi = sharePointApi;\n      this.todoListName = todoListName;\n      this.hideFinishedTasks = hideFinishedTasks;\n      this.loadTodos();\n      this.configurationNeeded = false;\n    }\n    else {\n      this.configurationNeeded = true;\n    }\n  }\n\n  private loadTodos(): void {\n    const vm: HomeController = this;\n    this.isLoading = true;\n    this.dataService.getTodos(vm.sharePointApi, vm.todoListName, vm.hideFinishedTasks)\n      .then((todos: ITodo[]): void => {\n        vm.todoCollection = todos;\n      })\n      .finally((): void => {\n        vm.isLoading = false;\n      });\n  }\n}"],"sourceRoot":"/src"}